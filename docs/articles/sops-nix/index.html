<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<title>Sops Nix: A Step-by-Step Guide | Abhinandh S</title>
	<link rel="canonical" href="http://localhost:1313/">
	<link rel='alternate' type='application/rss+xml' title="Abhinandh S RSS" href='/index.xml'>
	<link rel="icon" type="image/x-icon" href="/images/favicon/circle.svg">
	<link rel='stylesheet' type='text/css' href='/css/output.css'>
	<script src="/script.js" defer></script>
	
	<meta name="description" content="In this guide, we’ll walk through how to integrate Sops with Nix to securely manage secrets in your NixOS setup.
Step-1 Installing Sops via Flakes
To begin, we need to add sops-nix as a Flake input and include its module in your NixOS configuration:


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17


{
  inputs.sops-nix.url = &#34;github:Mic92/sops-nix&#34;;
  # optional, not necessary for the module
  #inputs.sops-nix.inputs.nixpkgs.follows = &#34;nixpkgs&#34;;

  outputs = { self, nixpkgs, sops-nix }: {
    # change `yourhostname` to your actual hostname
    nixosConfigurations.yourhostname = nixpkgs.lib.nixosSystem {
      # customize to your system
      system = &#34;x86_64-linux&#34;;
      modules = [
        ./configuration.nix
        sops-nix.nixosModules.sops
      ];
    };
  };
}


Replace yourhostname with the actual hostname of your machine.">
	
	<meta name="keywords" content="all , nix , nixos , linux">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="robots" content="index, follow">
	<meta charset="utf-8">
</head>

<body>
	
<div class="mb-3 font-bold">
    
    <nav class="bg-mocha-base shadow-md w-full min-h-32 max-tablet:min-h-16 top-0 left-0 z-10">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center pt-8 max-tablet:py-4">
                
                <div class="text-5xl max-tablet:text-2xl font-bold text-mocha-text"
                    style="font-family: 'Helvetica Neue', san-serif">ABHINANDH S<span class="text-vibez-red">.</span>
                </div>

                
                <div class="flex max-tablet:hidden space-x-6 mt-12 pb-7">
                    <a href="/" class="text-mocha-text visited:text-mocha-text hover:text-vibez-red">Home</a>
                    <a href="/portfolio"
                        class="text-mocha-text visited:text-mocha-text hover:text-vibez-red">Portfolio</a>
                    <a href="/articles"
                        class="text-mocha-text visited:text-mocha-text hover:text-vibez-red">Articles</a>
                    <a href="/about" class="text-mocha-text visited:text-mocha-text hover:text-vibez-red">About</a>
                </div>

                
                <div class="hidden max-tablet:flex">
                    
                    <button id="hamburger-btn" class="text-mocha-text focus:outline-none">
                        
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16m-7 6h7"></path>
                        </svg>
                    </button>
                </div>
            </div>

            
            <div id="mobile-menu" class="hidden md:hidden flex flex-col items-center">
                <a href="/"
                    class="block py-2 px-4 text-mocha-text hover:text-vibez-red visited:text-mocha-text">Home</a>
                <a href="/portfolio"
                    class="block py-2 px-4 text-mocha-text hover:text-vibez-red visited:text-mocha-text">Portfolio</a>
                <a href="/articles"
                    class="block py-2 px-4 text-mocha-text hover:text-vibez-red visited:text-mocha-text">Articles</a>
                <a href="/about"
                    class="block py-2 px-4 text-mocha-text hover:text-vibez-red visited:text-mocha-text">About</a>
            </div>
        </div>
    </nav>

    
    <script>
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        
        hamburgerBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
    </script>

</div>




	<main>
		<header>
			<h1 class="text-center font-extrabold" id="tag_Sops Nix: A Step-by-Step Guide">Sops Nix: A Step-by-Step Guide</h1>
		</header>
		<article>
			
			<p>In this guide, we’ll walk through how to integrate Sops with Nix to securely manage secrets in your NixOS setup.</p>
<h2 id="step-1-installing-sops-via-flakes">Step-1 Installing Sops via Flakes</h2>
<p>To begin, we need to add sops-nix as a Flake input and include its module in your NixOS configuration:</p>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="background-color:#3d4148"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="background-color:#3d4148"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="background-color:#3d4148"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-nix" data-lang="nix"><span style="display:flex;"><span>{
</span></span><span style="display:flex; background-color:#3d4148"><span>  <span style="color:#e06c75">inputs</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sops-nix</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">url</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;github:Mic92/sops-nix&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># optional, not necessary for the module</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e">#inputs.sops-nix.inputs.nixpkgs.follows = &#34;nixpkgs&#34;;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex; background-color:#3d4148"><span>  <span style="color:#e06c75">outputs</span> <span style="color:#56b6c2">=</span> { <span style="color:#e06c75">self</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">nixpkgs</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">sops-nix</span> }: {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e"># change `yourhostname` to your actual hostname</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">nixosConfigurations</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">yourhostname</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">nixpkgs</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">lib</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nixosSystem</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#7f848e"># customize to your system</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">system</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;x86_64-linux&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">modules</span> <span style="color:#56b6c2">=</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#98c379">./configuration.nix</span>
</span></span><span style="display:flex; background-color:#3d4148"><span>        <span style="color:#e06c75">sops-nix</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">nixosModules</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sops</span>
</span></span><span style="display:flex;"><span>      ];
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Replace yourhostname with the actual hostname of your machine.</p>
<h2 id="step-2---generate-an-age-key">Step 2 - Generate an Age Key</h2>
<p>Next, you need to generate an age key for encryption, you can use gpg keys but age is considered more safe and secure:</p>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-fish" data-lang="fish"><span style="display:flex;"><span><span style="color:#61afef;font-weight:bold">mkdir</span> <span style="color:#e06c75">-p</span> ~/.config/sops/age
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#61afef;font-weight:bold">age-keygen</span> <span style="color:#e06c75">-o</span> ~/.config/sops/age/keys.txt
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="step-3---create-a-sopsyaml-file-at-the-root-of-your-nix-config">Step 3 - create a .sops.yaml file at the root of your nix config</h2>
<ul>
<li>Put the age public key which we use to encrypt the files in sops config file .sops.yaml</li>
<li>Then the relative path to secrets files</li>
<li>and key groups</li>
</ul>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#e06c75">keys</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#7f848e">&amp;user</span> age12zlz6lvcdk6eqaewfylg35w0syh58sm7gh53q5vvn7hd7c6nngyseftjxl
</span></span><span style="display:flex;"><span><span style="color:#e06c75">creation_rules</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#e06c75">path_regex</span>: secrets/secrets.yaml$
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">key_groups</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#e06c75">age</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#7f848e">*user</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="step-4---create-a-sops-file">Step 4 - Create a sops file</h2>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-fish" data-lang="fish"><span style="display:flex;"><span> <span style="color:#61afef;font-weight:bold">sops</span> secrets/secrets.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><p>It will look like this</p>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Files must always have a string value</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">example-key</span>: example-value
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Nesting the key results in the creation of directories.</span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># These directories will be owned by root:keys and have permissions 0751.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">myservice</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">my_subdir</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">my_secret</span>: password1
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Check the secrets.yaml file</li>
</ul>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3d4148"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-fish" data-lang="fish"><span style="display:flex; background-color:#3d4148"><span><span style="color:#61afef;font-weight:bold">cat</span> secrets/secrets.yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#61afef;font-weight:bold">example-key</span>: ENC<span style="color:#56b6c2">[</span>AES256_GCM,data:AB8XMyid4P7mXdjj+<span style="color:#e06c75">A</span><span style="color:#56b6c2">==</span>,iv:RRsZC+V+3w22pOi/2TCjBYn/<span style="color:#e06c75">0OYsNGCu5CT1ZBSKGi0</span><span style="color:#56b6c2">=</span>,tag:<span style="color:#e06c75">zT5mlujrSuA6KKxLKL8CMQ</span><span style="color:#56b6c2">==</span>,<span style="color:#e5c07b">type</span>:str<span style="color:#56b6c2">]</span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">#ENC[AES256_GCM,data:59QWbzCQCP7kLdhyjFOZe503MgegN0kv505PBNHwjp6aYztDHwx2N9+A1Bz6G/vWYo+4LpBo8/s=,iv:89q3ZXgM1wBUg5G29ROor3VXrO3QFGCvfwDoA3+G14M=,tag:hOSnEZ6DKycnF37LCXOjzg==,type:comment]
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e">#ENC[AES256_GCM,data:kUuJCkDE9JT9C+kdNe0CSB3c+gmgE4We1OoX4C1dWeoZCw/o9/09CzjRi9eOBUEL0P1lrt+g6V2uXFVq4n+M8UPGUAbRUr3A,iv:nXJS8wqi+ephoLynm9Nxbqan0V5dBstctqP0WxniSOw=,tag:ALx396Z/IPCwnlqH//Hj3g==,type:comment]
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#61afef;font-weight:bold">myservice</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">my_subdir</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#61afef;font-weight:bold">my_secret</span>: ENC<span style="color:#56b6c2">[</span>AES256_GCM,data:hcRk5ERw60G5,iv:3Ur6iH1Yu0eu2otcEv+<span style="color:#e06c75">hGRF5kTaH6HSlrofJ5JXvewA</span><span style="color:#56b6c2">=</span>,tag:<span style="color:#e06c75">hpECXFnMhGNnAxxzuGW5jg</span><span style="color:#56b6c2">==</span>,<span style="color:#e5c07b">type</span>:str<span style="color:#56b6c2">]</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef;font-weight:bold">sops</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">kms</span>: <span style="color:#56b6c2">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">gcp_kms</span>: <span style="color:#56b6c2">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">azure_kv</span>: <span style="color:#56b6c2">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">hc_vault</span>: <span style="color:#56b6c2">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">age</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">- recipient</span>: age12zlz6lvcdk6eqaewfylg35w0syh58sm7gh53q5vvn7hd7c6nngyseftjxl
</span></span><span style="display:flex;"><span>          <span style="color:#61afef;font-weight:bold">enc</span>: <span style="color:#56b6c2">|</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e06c75">-----BEGIN</span> AGE ENCRYPTED FILE-----
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0</span>+IFgyNTUxOSB1dFYvSTRHa3IwTVpuZjEz
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">SDZZQnc5a0dGVGEzNXZmNEY5NlZDbVgyNVU0Clo3ZC9MRGp4SHhLUTVCeWlOUUxS</span>
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">MEtPdW4rUHhjdFB6bFhyUXRQTkRpWjAKLS0tIDVTbWU2V3dJNUZrK1A5U0c5bkc0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">S3VINUJYc3VKcjBZbHVqcGJBSlVPZWcKqPXE01ienWDbTwxo</span>+z4dNAizR3t6uTS+
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">KbmSOK1v61Ri0bsM5HItiMP</span>+fE3VCyhqMBmPdcrR92+<span style="color:#e06c75">3oBmiSFnXPA</span><span style="color:#56b6c2">==</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e06c75">-----END</span> AGE ENCRYPTED FILE-----
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">- recipient</span>: age18jtffqax5v0t6ehh4ypaefl4mfhcrhn6ek3p80mhfp9psx6pd35qew2ww3
</span></span><span style="display:flex;"><span>          <span style="color:#61afef;font-weight:bold">enc</span>: <span style="color:#56b6c2">|</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e06c75">-----BEGIN</span> AGE ENCRYPTED FILE-----
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0</span>+IFgyNTUxOSBzT3FxcDEzaFRQOVFpNkg2
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">Skw4WEIxZzNTWkNBaDRhcUN2ejY4QTAwTERvCkx2clIzT2wyaFJZcjl0RkFXL2p6</span>
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">enhqVEZ3ZkNKUU5jTlUxRC9Lb090TzAKLS0tIDBEaG00RFJDZ3ZVVjBGUWJkRHdQ</span>
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">YkpudG43eURPVWJUejd3Znk5Z29lWlkK0cIngn2qdmiOE5rHOHxTRcjfZYuY3Ej7</span>
</span></span><span style="display:flex;"><span>            <span style="color:#61afef;font-weight:bold">Yy7nYxMwTdYsm</span>/V6Lp2xm8hvSzBEIFL+<span style="color:#e06c75">JXnSTSwSHnCIfgle5BRbug</span><span style="color:#56b6c2">==</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e06c75">-----END</span> AGE ENCRYPTED FILE-----
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">lastmodified</span>: <span style="color:#98c379">&#34;2021-11-20T16:21:10Z&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">mac</span>: ENC<span style="color:#56b6c2">[</span>AES256_GCM,data:5ieT/yv1GZfZFr+OAZ/DBF+6DJHijRXpjNI2kfBun3KxDkyjiu/OFmAbsoVFY/<span style="color:#e06c75">y6YCT3ofl4Vwa56Veo3iYj4njgxyLpLuD1B6zkMaNXaPywbAhuMho7bDGEJZHrlYOUNLdBqW2ytTuFA095IncXE8CFGr38A2hfjcputdHk4R4</span><span style="color:#56b6c2">=</span>,iv:<span style="color:#e06c75">UcBXWtaquflQFNDphZUqahADkeege5OjUY38pLIcFkU</span><span style="color:#56b6c2">=</span>,tag:yy+HSMm+xtX+<span style="color:#e06c75">vHO78nej5w</span><span style="color:#56b6c2">==</span>,<span style="color:#e5c07b">type</span>:str<span style="color:#56b6c2">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">pgp</span>: <span style="color:#56b6c2">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">unencrypted_suffix</span>: _unencrypted
</span></span><span style="display:flex;"><span>    <span style="color:#61afef;font-weight:bold">version</span>: <span style="color:#d19a66">3</span>.<span style="color:#d19a66">7</span>.<span style="color:#d19a66">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="step--5">Step -5</h2>
<div class="highlight my_codeblock"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-nix" data-lang="nix"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">imports</span> <span style="color:#56b6c2">=</span> [ <span style="color:#98c379">&lt;sops-nix/modules/sops&gt;</span> ];
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># This will add secrets.yml to the nix store</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># You can avoid this by adding a string to the full path instead, i.e.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># sops.defaultSopsFile = &#34;/root/.sops/secrets/example.yaml&#34;;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">defaultSopsFile</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">./secrets/example.yaml</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># This will automatically import SSH keys as age keys</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">age</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">sshKeyPaths</span> <span style="color:#56b6c2">=</span> [ <span style="color:#98c379">&#34;/etc/ssh/ssh_host_ed25519_key&#34;</span> ];
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># This is using an age key that is expected to already be in the filesystem</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">age</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">keyFile</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;/var/lib/sops-nix/key.txt&#34;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># This will generate a new key if the key specified above does not exist</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">age</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">generateKey</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">true</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#7f848e"># This is the actual specification of the secrets.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">secrets</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">example-key</span> <span style="color:#56b6c2">=</span> {};
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">sops</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">secrets</span><span style="color:#56b6c2">.</span><span style="color:#98c379">&#34;myservice/my_subdir/my_secret&#34;</span> <span style="color:#56b6c2">=</span> {};
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div>
			
			<div id="nextprev"><a href="/articles/how-to-set-up-godaddy-domain-with-github-pages/">
    <div class="font-bold float-right text-right max-w-44 p-5">Next:<br>How to Set Up GoDaddy Domain With GitHub Pages</div>
  </a>
  </div>
<div class="font-bold text-center clear-both">Related tags<br><a class="font-bold" id="tag_all" href="http://localhost:1313/tags/all">All</a> &middot; <a class="font-bold" id="tag_nix" href="http://localhost:1313/tags/nix">Nix</a> &middot; <a class="font-bold" id="tag_nixos" href="http://localhost:1313/tags/nixos">Nixos</a> &middot; <a class="font-bold" id="tag_linux" href="http://localhost:1313/tags/linux">Linux</a></div>
</article>
		<footer class="text-center clear-both">
    <div>
        <br><br>
        <div class="flex justify-center"><a class="p-2" href="https://github.com/abhi-xyz/" target="_blank"><img
                    src="/images/icons/github.svg" style="max-height:1.5em" alt="GitHub"
                    title="Subscribe via RSS for updates."></a><a class="p-2" href="mailto:abhinandhsuby@proton.me"><img
                    src="/images/icons/mail.svg" target="_blank" style="max-height:1.5em" alt="Email"
                    title="Subscribe via RSS for updates."></a><a class="p-2" href="/index.xml" target="_blank"><img src="/images/icons/rss.svg"
                    style="max-height:1.5em" alt="RSS Feed" title="Subscribe via RSS for updates."></a><a class="p-2" href="https://x.com/Ungraduate_Abhi" target="_blank"><img
                    src="/images/icons/twitter.svg" style="max-height:1.5em" alt="Twitter"
                    title="Subscribe via RSS for updates."></a>
        </div>
        <p class="p-3">
            The website’s source code is licensed under the <a href="https://opensource.org/license/mit">MIT License</a>
            and is available <a href="https://github.com/abhi-xyz/abhi-xyz.github.io">here</a>.
            Articles are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">Creative
                Commons with the Share-alike Clause (CC-BY-SA 4.0)</a>.
        </p>
        <br>
        <br>
    </div>
</footer>

	</main>
	
</body>

</html>
